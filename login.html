<!-- NOTE:: This uses a cookie to pass the username from the login screen
	    to the client screen. Chrome does not support cookies for local 
	    files. It **should** work in Chrome when deployed, but it must
	    be tested locally in a different browser
-->

<html>
  <head>
    <link rel="stylesheet" type="text/css" href="login.css">
		<title>AceChat - Login</title>
  </head>

  <body>

    <div class="loginbox">
      <h3>
	Who are you?
      </h3>

      <div class="textarea">
				<div id="inputprompt"class="textbox">
          <input type="text" placeholder="Your name here (/^[A-z0-9]{1,10}$/)"id="login-prompt"onkeydown="if(event.keyCode == 13)
												      login();" />
        <div class="textbutton">
					<input type="button" id="loginbutton" Value="Send" onclick="login();"/>
        </div>
        </div>

				<br>
				<br>
				<br>
				<span id="warning">
					(Don't change this unless you know what you're doing!)
				</span>
				<div class="textbox">
					<input type="text" value="acechat.dyladan.me/ws/" id="server"  
						onkeydown="if(event.keyCode == 13)   
																							login();"/>
				</div>

      </div>
    </div>

  </body>
</html>

<script type="text/javascript">

	window.onload = function focus()
	{
		document.getElementById('login-prompt').focus();
	};

  function createCookie(name,value,days) 
  {
    if (days) {
      var date = new Date();
      date.setTime(date.getTime()+(days*24*60*60*1000));
      var expires = "; expires="+date.toUTCString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
  }


  function login()
  {
    var usrName= document.getElementById('login-prompt').value;
    usrName = usrName.split(" ")[0];
		if(usrName.toLowerCase() == "acechat"|| !usrName.match(/^[A-z0-9]{1,10}$/))
		{
			window.alert("Username must not contain spaces or special characters and must be one to ten characters long. Username may not be any form of \"AceChat\".");
			return;
		}

		var server = document.getElementById('server').value;

    document.getElementById("login-prompt").value = "";
    document.getElementById("server").value = "acechat.dyladan.me";

    var form = document.createElement('form');
    createCookie("user", usrName,5);
		createCookie("server",server,5);
    
    form.setAttribute('method', 'post');
    form.setAttribute('action', 'index.html');
    form.style.display = 'hidden';
    document.body.appendChild(form)
    form.submit();
    
  }

</script>
