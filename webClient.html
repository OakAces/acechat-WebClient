<!-- NOTE:: This uses a cookie to pass the username from the login screen
	    to the client screen. Chrome does not support cookies for local 
	    files. It **should** work in Chrome when deployed, but it must
	    be tested locally in a different browser
-->

<html>
  <head>

    <link rel="stylesheet" type="text/css" href="webUI.css">

  </head>

  <body class="body">
    <div class="left-column">
      <h3>
	Channel List
      </h3>
      <div class="channel-list">

      <!-- TODO : POPULATE WITH CHANNELS FROM SERVER -->

      </div>

      <button class="logout-button"name="logout"type="button">LOGOUT</button>
    </div>

    <!--top bar-->
    <div class="top-bar">
      <!-- TODO : Populate from server-->
      Channel Name : Channel Details
    </div>

    <!--right -->
    <div class="right">
      <h3>
	Online
      </h3>
      <!-- TODO : POPULATE WITH USERS FROM SERVER -->
      <div class="online-list">
      </div>
    </div>

    <!--center-->
    <div class="center">
      <div class="chat-log">
	<!-- TODO : Populate from server-->
      </div>


      <!-- TODO : Send to server -->
      <div class="textarea">
	>&nbsp
	<div class="textbox">
	  <input type="text"autocomplete="off" placeholder="Say Something!"id="chat-prompt"onkeydown="if(event.keyCode == 13)
											parseInput();"/>
	</div>
	<div class="textbutton">
	  <input type="button" id="textbutton" Value="Send" onclick="parseInput();"/>
	</div>
      </div>

    </div>

  </body>


</html>
  
  
  
<script type="text/javascript">

  //current channel
  var channel = "default";

  //channels currently "joined"
  var channels = ["default"];

  //must be logged in to access this page
  if(!document.cookie)
    window.location="login.html";

  //login with server
  userName = document.cookie.split('=')[1];
  usrMsg = {
	    "command" : "USER",
	    "args" : [userName]
	   }
  send(usrMsg);


  //sends object to sever
  function send(e)
  {}
  
  //gets user list from server, returns as array of strings
  function usrList()
  {
    return [userName];
  }

  //gets channel list from server, returns as array of strings
  function channelList()
  {}

  //joins the channels specified by an array of strings
  function join(e)
  {
    msg = {
	    "command" : "JOIN",
	    "args" : e
	  }
    send(msg);
  }

  //leaves the channels specified by an array of strings 
  function part(e)
  {
    msg = {
	    "command" : "PART",
	    "args" : e
	  }
    send(msg);
  }

  //invite users to channel
  //args in the form channel, user0, user1,..,usern
  function invite(e)
  {
    msg = {
	    "command" : "INVITE",
	    "args" : e
	  }
    send(msg);
  }

  //list channels on server
  function chanlist
  {
    msg = {
	    "command" : "CHANLIST",
	    "args" : []
	  }
    send(msg);
  }

  

  function createCookie(name,value,days) 
  {
    if (days) {
      var date = new Date();
      date.setTime(date.getTime()+(days*24*60*60*1000));
      var expires = "; expires="+date.toUTCString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
  }
  
  function parseInput()
  {
    var msgTxt = document.getElementById("chat-prompt").value;
    var msgArr = msgTxt.split(" ");
    document.getElementById("chat-prompt").value = "";
    
    //if input begins with /validUsrName, send private message
    if (msgTxt.match(/^\(msg\)( |$)/) && !!~usrList().indexOf(msgArr[1]))
    {
      msgArr.shift();
      msgArr.shift();
      msgTxt = msgArr.join(" ");
      msg = {
	      "command" : "PRIVMSG",
	      "args" : [msgArr[1],msgTxt]
	    }
      send(msg);
    }

    //logout, logoff
    //parts all channels, logs out
    else if (msgTxt.match(/^\(logoff\)( |$)/) || msgTxt.match(/^\(logout\)( |$)/))
    {
      part(channels);
      createCookie("user","",-1);
      window.location="login.html";
    }

    //default, send message to current channel
    else
    {
      msg = {
              "command" : "MSG",
	      "args" : [channel, msgTxt]
	  
	    }
      send(msg);
    }
  }

</script>


